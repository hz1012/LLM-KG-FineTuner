印巴硝烟下南亚网络空间的明枪暗箭

高级威胁研究院 2025年05月21日 18:07 北京 原创 360威胁情报中心

前言

半个多世纪以来，印度与巴基斯坦关系时紧时缓，双方之间的矛盾源于领 土、宗教、地缘博弈等多重原因。两国关系长期陷于'对抗-短暂缓和-再对抗' 的循环，尤其是双方在克什米尔地区的武装冲突几乎从未中断，成为南亚地区的 火药桶。


印巴历史冲突时间线

1 9 4 7 . 8

印度、巴基斯坦正式分治

1 9 4 7 . 1 0

印度与巴基斯坦两国由于克什米尔的归属问题发生武装冲突，引发 '第一次印巴战争'

1 9 6 0 . . . .

印巴双方签署《印度河水条约》，解决分享流经两国的印度河河水 问题

1 9 6 5 - 1 9 6 6

爆发'第二次印巴战争'

1 9 7 1 . . . .

东巴基斯坦爆发脱离巴基斯坦的独立运动，爆发'第三次印巴战 争'，促成了'东巴基斯坦'地区独立为孟加拉国

1 9 9 9 . 5

印度出动战机对印控克什米尔的卡吉尔和达拉斯地区进行空中打击

2 0 0 3 . 1 1

印度与巴基斯坦在克什米尔地区实际控制线实现停火


2025年4月22日，印控克什米尔地区发生针对游客的恐怖袭击；当地时间23日晚， 印度宣布暂停河水共享等多项报复措施；24日，巴基斯坦宣布一系列对印反制措施，印 巴两军在克什米尔控制线沿线发生小规模交火；直至5月7日，印度武装部队发起代号为 '朱砂'的行动，打击巴基斯坦和巴控克什米尔地区的设施，印巴冲突再次升级。

2025年5月10日，印度同巴基斯坦达成停火协议。

活跃在南亚网络空间的APT攻击

在本次#印巴冲突 爆发前，360高级威胁研究人员在对全球网络空间的持续监测 中，捕获到在南亚地区网络空间的APT组织活跃攻击活动。南亚网络空间上的明枪暗 箭，也印证了印巴两国剑拔弩张的发展态势。


## 1. APT组织攻击领域和意图

在印巴矛盾冲突持续发展期间，活跃在南亚地区网络空间的APT组织主要为APT-C24(#响尾蛇)、APT-C-35(#肚脑虫)、APT-C-08(#蔓灵花)、APT-C-09(#摩诃草)等。 其中印方向网络攻击组织主要以周边地缘国家政府外交、国防军事、交通运输等关键行 业领域作为首要目标。被攻击目标除集中在巴基斯坦地区外，还影响到孟加拉国、尼泊 尔、斯里兰卡等南亚以及周边国家和地区。

2024年1月-2025年4月期间针对巴基斯坦网络攻击活跃度


## 2. 部分活跃APT组织攻击活动

## 2.1 APT-C-24(响尾蛇)

我们监测到APT-C-24(响尾蛇)组织在近期的网络攻击中，使用大量伪装成政府机 构、军队网站域名格式的C2域名。

| 响尾蛇组织攻击使用的C2域名                          | 伪装目标   |
|-----------------------------------------|--------|
| opmcm-gov-np.fia-gov[.]net              | 尼泊尔政府  |
| navy-lk.direct888[.]net                 | 斯里兰卡海军 |
| moitt-gov-pk.fia-gov[.]net              | 巴基斯坦政府 |
| moitt.paknavy-govpk[.]info              | 巴基斯坦海军 |
| www-army-mil-bd.dirctt88[.]co           | 孟加拉陆军  |
| heatwave.paknavy[.]store                | 巴基斯坦海军 |
| paknavy-gov-pk.dirctt888[.]info         | 巴基斯坦海军 |
| mail.navy.mil.bd.docum[.]store          | 孟加拉海军  |
| pimec-paknavy.updates-installer[.]store | 巴基斯坦海军 |
2024年1月，APT-C-24（响尾蛇）组织使用与巴基斯坦海军相关的诱饵文档，向 巴基斯坦海军相关目标投递鱼叉钓鱼邮件。

印巴硝烟下南亚网络空间的明枪暗箭

响尾蛇组织使用的与巴海军相关的诱饵文档

2024年9月，响尾蛇组织使用人工智能政策相关的诱饵文档，对巴基斯坦政府机构 展开鱼叉钓鱼邮件攻击。

响尾蛇组织使用的与巴海军相关的诱饵文档

2025年4月，响尾蛇组织使用了与网络安全相关话题的诱饵文档对巴基斯坦海军展 开鱼叉钓鱼邮件攻击。在此期间，响尾蛇组织还对地缘周边的尼泊尔、斯里兰卡等国展 开攻击，以窃取相关情报。其中在对斯里兰卡的攻击活动中，使用了涉及我国国际交换 生相关题材的诱饵文档。


响尾蛇组织使用的海军网络安全审计相关的诱饵文档

响尾蛇组织使用的尼泊尔签证题材相关钓鱼文档


响尾蛇组织使用的斯里兰卡国际交换生题材钓鱼文档

## 2.2 APT-C-08(蔓灵花)

APT-C-08(蔓灵花)组织在近期的攻击活动中也大量使用与周边国家政府、军队相关 的钓鱼网页。2024年4月，蔓灵花组织开始使用.searchconnector-ms文件作为初始访 问阶段的攻击载荷。


蔓灵花组织使用的与斯里兰卡空军、陆军相关钓鱼页面

蔓灵花组织使用的孟加拉政府、海军相关钓鱼页面


## 2.3 APT-C-09(摩诃草)

2024年4月，APT-C-09(摩诃草)组织通过投递带有地域特色话题的inp漏洞文档， 针对地缘周边国家展开网络攻击。

| 诱饵文档标题                                               | 文档说明            |
|------------------------------------------------------|-----------------|
| Visit of the Chinese Delegation in Karachi, Si ndh   | 外交相关，涉及我国外交访问相关 |
| afghan national report daily                         | 阿富汗国家日报         |
| profile of tehrik-e-taliban pakistan (ttp)           | 巴基斯坦塔利班运动相关     |
| list of suspected afghan nationals involved with ttp | 巴基斯坦塔利班运动相关     |
| AJK Police Officers Selected For The 2025 A wards    | 巴基斯坦警察相关        |
APT组织攻击技战术分析

## 1. APT-C-24（响尾蛇）

## 1.1 攻击技战术总结

我们通过对捕获的印巴持续对抗阶段响尾蛇组织对巴基斯坦相关目标攻击活动分 析，该组织主要使用两种攻击流程。

其一：通过投递带有CVE-2017-0199和CVE-2017-11882漏洞利用的文档作为初 始访问阶段攻击载荷，继而通过漏洞触发远程执行JavaScript脚本后加载后续攻击组 件。

响尾蛇组织近期攻击流程一


其二：通过投递带有恶意lnk的压缩包作为初始访问阶段的攻击载荷，该恶意lnk文 件被执行后，将通过mshta远程加载hta脚本，进而执行其携带的JavaScript脚本，并在 内存中加载后续攻击组件。


响尾蛇组织近期攻击流程二

## 1.2 攻击样本分析

## 1.2.1 漏洞文档

360近期捕获到响尾蛇组织使用的投递带有CVE-2017-0199和CVE-2017-11882 漏洞利用文档的钓鱼邮件如下：


响尾蛇组织钓鱼邮件


响尾蛇组织钓鱼邮件中的恶意文档内容

该恶意文档打开后，将会远程加载后续的rtf文档。由于攻击者服务器配置设置，非 目标区域尝试下载该类文档会得到一个带有rtf头的空文档，而当目标区域用户执行，将 会触发漏洞利用，进而执行JavaScript脚本。


远程加载后续的rtf文档，触发漏洞利用

## 1.2.2 Lnk文件

| MD5                                                     | 193a676eb9f32a8106ac4282eca90385         |
|---------------------------------------------------------|------------------------------------------|
| SHA1                                                    | 16eb9c186008d143094a096fa2c3126504b7a95a |
| fe99b7da3b46468f90801e13c13d213b9bca34433b71bd113916545 | SHA256 535f0288a                         |
| LNK                                                     | 文件类型                                     |
| 文件名                                                     | Appx A.jpg.lnk                           |
该样本在执行后将会远程加载：https://mailafdgovbd.163inc[.]org/b965f3catictrainingdayforbd/hta?q=1

Lnk样本运行后执行远程加载


## 1.2.3 Hta脚本

响尾蛇组织使用的hta脚本内携带了一段JavaScript脚本，通过base64解码并加

载。

hta脚本通过base64解码并加载


## 1.2.4 Javascript脚本

响尾蛇组织使用的Javascript脚本通常由NotNetToJScript项目生成，主要功能为 释放诱饵文档和加载.Net程序集。该脚本中包含对用户机器物理内存空间大小检查的逻 辑，以对抗虚拟机环境。

Javascript脚本中检查物理内存空间逻辑


## 1.2.5 后门组件app.dll

app.dll组件一般充当下载器使用，从远端服务器获取后续的攻击组件并执行，其获 取的远端数据通过异或算法解密，其数据头部前32字节为key。

后门组件：app.dll


## 1.2.6 后门组件sxshared.dll

该组件为JavaScript加载器，用于连接远端服务器获取后续JavaScript脚本，并在 内存中执行。

后门组件：sxshared.dll


## 1.2.7 后门组件Dwrite.dll

该组件为加载器，通常带有混淆，功能为从指定文件中加载执行后续组件。

后门组件：Dwrite.dll


1.2.8 后门组件Moduleinstaller.dll

该组件为持久化组件，在此组件中有任务计划的创建，启动项中驻留，收集系统信 息并回传等功能，并且仍然有下发后续组件的功能。

后门组件持久化操作


后门组件下载操作


## 2. APT-C-08（蔓灵花）

## 2.1 攻击技战术总结

APT-C-08 （ 蔓 灵 花 ） 组 织 在 近 期 的 攻 击 活 动 ， 主 要 以 chm 文 件 和 searchconnector-ms文件作为初始载荷，对巴基斯坦相关目标展开钓鱼攻击。诱饵文 档主题以商业合作、军事演习为主。受害者点击样本后，创建一个周期性计划任务，向 C2发送设备和用户信息，并接收C2传回的powershell或cmd指令，用于下载执行后续 的后门和窃密组件。

蔓灵花组织攻击流程示意


## 2.2样本分析

## 2.2.1 投递载荷

蔓灵花针对巴基斯坦的钓鱼邮件攻击中使用的searchconnector-ms文件是 Windows 系统中用于搜索连接器的配置文件。在simpleLocation标签中，记录了远程 地址。用户在点击样本后，会通过webdav协议将远程文件映射到本地。


映射的文件为伪装成pdf文件的快捷方式，快捷方式的指令会创建一个周期性的计 划任务，用于下载执行后续组件。

计划任务指令周期性执行，将设备名和用户名信息回传到C2。从C2下载 powershell或cmd指令，以图片或其他扩展名的方式保存在用户路径下。


2.2.2 后门组件uvcresc.exe

| MD5         | 45a0b47a3e6a6f331d73b7968433e7f1   |
|-------------|------------------------------------|
| 文件名称        | uvcresc.exe                        |
| 文件大小 138.00 | KB (141312 bytes)                  |
| 文件类型 Win32  | EXE                                |
uvcresc.exe后门组件主要功能为键盘记录器。通过SetWindowsHookExW设置键 盘消息回调函数，用于获取键盘按键信息等。随后创建线程用于将记录的按键数据保存 到本地文件。

键盘钩子捕获普通按键按下和组合键按下的消息。按键符合要求时，样本尝试获取 当交互窗口的窗口名称。随后判断shift和Control是否按下。

判断是否Ctrl+v，获取剪切板的数据。

数据处理线程会解析按键数据，888888表示解析窗口名称，999999表示解析剪切 板数据。之后将解析的数据写入文件。 以OPEN\_ALWAYS 创 建 文 件 ， 文 件 名 为 对 应 窗 口 的 名 称 。 文 件 保 存 在

APPDATA\\Microsoft\\Common-Files路径下。

印巴硝烟下南亚网络空间的明枪暗箭

2.2.3 后门组件mvsnci.exe

| MD5        | fd5839224cdf353f803d60e6db78ed1c   |
|------------|------------------------------------|
| 文件名称       | mvsnci.exe                         |
| 文件大小 92.00 | KB (94208 bytes)                   |
| 文件类型       | Win32 EXE                          |
mvsnci.exe组件的主要功能是负责远程控制。样本主要创建两个线程，其中一个负 责向C2发送数据，另一个线程负责从C2接收数据并执行对应的指令。

样本接收指令时，首先会接收一个四字节数据，该数据为功能序号，之后样本根据 功能序号执行不同功能。


功能列表如下：

|   功能序号 | 功能描述                      |
|--------|---------------------------|
|      0 | 遍历文件夹获取文件列表               |
|      2 | 写入模式打开文件                  |
|      3 | 创建pipe隧道执行进程回传执行结果（cmd指令） |
|      7 | 关闭pipe隧道                  |
|      8 | 写入隧道                      |
|     10 | 文件数据上传（指定偏移位置）            |
|     13 | 文件直接上传                    |
|     14 | 获取文件夹或文件时间信息              |
|     22 | 截屏                        |
|     23 | 大文件上传                     |
## 3. APT-C-08（摩诃草）

## 3.1 攻击技战术总结

APT-C-08（摩诃草）组织针对巴基斯坦的钓鱼攻击，主要使用inp文档作为初始载 荷。以克什米尔、恐怖主义、间谍窃密等巴基斯坦相关敏感话题作为文档主题。InPage 是南亚、中东地区广泛使用的专业排版软件，流行的InPage 2012等版本普遍存在CVE2017-12824漏洞。攻击者正是针对此漏洞投递钓鱼文档进行攻击。用户点击后，触发 漏洞，随后会加载其他后门组件。

摩诃草组织攻击流程示意


## 3.2 攻击样本分析

## 3.2.1 后门组件fonticonhost.exe

摩诃草组织针第一阶段的载荷fonticonhost.exe信息如下：

| 文件名称   | fonticonhost.exe                 |
|--------|----------------------------------|
| MD5    | 042b2cf09b2e83ea706c09e49aa48fae |
该文件带有数字签名'GREATIV LIMITED'。fonticonhost.exe具有下载执行，收集 信息等功能，与该组织在历史攻击活动中使用的'WarHawk'木马功能相似。

从资源段中解密出相关的配置信息。

与服务器交互，回传hwid和mail信息，如果接收数据为'1'时程序则sleep。


创建任务计划，配置文件中agent字段为3时复制文件到%appdata%目录下根据配 置文件中的第4个参数命名(该程序为'DllHostcache')并创建任务计划定时执行，共创建 5个任务计划。

继续向服务器回传信息包括hwid、username、computername、osname、操 作系统架构、反病毒程序等。随后通过配置文件中的第二个url下发后续组件 'gameinput.exe'并通过cmd执行。

除此之外还继续向服务器发送hwid并判断根据返回值请求不同的组件类型下发执

行。


接收数据为'1'时我们发现该组件为dll组件，执行该dll的导出函数在配置文件中， 结合我们数据发现同种类型的dll组件并进行后续分析。

## 3.2.2 后门组件slb.dll

摩诃草组织第二阶段的slb.dl组件拥有丰富的功能，包括遍历所有磁盘目录收集指 定文件信息回传，屏幕截图、浏览器窃密、下载组件并执行等。

遍历磁盘目录收集信息。

屏幕截图功能。

下发执行功能。

浏览器窃密功能，并将窃取信息以POST方式回传给服务端，同样以hwid方式区分

受害者设备。

## 4. APT-C-35（肚脑虫）

## 4.1 攻击技战术总结

本次地缘冲突期间，肚脑虫组织主要通过投递带有恶意宏文档或带有漏洞的inpage 文档作为附件的鱼叉邮件，为初始访问阶段的攻击载荷。当用户打开此恶意文档后，通 过恶意vbs宏或是inp漏洞（CVE-2017-12824等）利用释放并加载后续的攻击载荷。

在近期攻击活动中，肚脑虫组织开始使用伪装的恶意ppt文档作为初始访问阶段攻 击载荷，通过将文档中的内容模糊处理来诱导用户点击钓鱼链接，下载后续的攻击载荷 完成后门的植入。

肚脑虫组织攻击流程示意


## 4.2 攻击样本分析

## 4.2.1 恶意PPT文档

肚脑虫组织使用的恶意ppt文档，通过对图片进行模糊处理，诱骗用户点击钓鱼链 接。用户点击链接后，会从攻击者事先准备的托管服务器中下载后续的ppt文件。接下 来的ppt文件内带有vba宏脚本。用户执行ppt文件启用宏，会执行相应的vba脚本下载 并执行后续组件。

攻击者对图片进行模糊处理


下载并执行后续恶意组件


## 4.2.2 后门组件DZSunE2w8t.dll

| MD5    | 947a2211b9fa887dfe648414d5751643                                  |
|--------|-------------------------------------------------------------------|
| SHA1   | be27b681e5f5c434e52bf18814ed6786b4376810                          |
| SHA256 | a30eb04fd576f7e82ac518601f42de76b26f84733d534da076e142c0 9852fe95 |
| 文件类型   | Win32 DLL                                                         |
| 文件名    | %UserProfile%\AppData\Local\Temp\LogicGate\DZSunE2w8t.dll         |
该样本为第一阶段恶意文档释放的后门组件，有两个导出函数起到实际作用。

## 4.2.2.1 导出函数?Cvfinder@@YAHXZ

该导出函数的主要功能是用于初始化部署样本获取Temp\LogicGate路径，随机生 成一个长度为10的dll文件名称。

样本会将自身复制到该路径，并以随机名称重名。并且设计计划任务。/create /tn "BackupDrive" /tr "C:\Windows\Sysnative\rundll32.exe "%UserProfile%\AppData\Local\Temp\LogicGate\DZSunE2w8t.dll",? ConFinder@@YAHXZ" /sc minute /mo 7

## 4.2.2.2 导出函数?ConFinder@@YAHXZ

该导出函数的主要功能是负责下载后续恶意文件。

样本创建一个互斥体

样本内部分使用的字符串是二进制格式字符串。


其中部分字符串并未使用过，例如：


样本获取本地计算机信息。


通过GetComputerNameW获取计算机名称，通过GetUserNameW获取用户名。 通过访问Software\Microsoft\Windows\CurrentVersion\Uninstall获取当前系统安 装的程序列表。


数据拼接格式'用户名计算机名称|||软件安装列表'?'分割|||SGW20'


随后将收集到的本地数据进行AES加密运算。再进行base64码，并添加batac=前 缀。其中key: 32 A3 D5 97 6E 5A BC F5 C4 68 A8 24 69 E5 C7 91，IV: 29 A9 B9 E9 E7 E5 E1 A3 A8 67 54 28 BC B7 A2 BE。使用CBC模式。


源Zokonomestreka52perscv/komonikametapikolocorty。主要功能是连接C2，上 传获取的机器信息。并判断C2返回的数据。 如果接受数据满足研判逻辑，会退出。否则会持续同C2通信。

样 本 第 二 次 访 问 C2 ， 接 受 C2 传 来 的 数 据 。 本 次 访 问 的 资 源 是 Dekonobetaprastersfi/xopremosatabikanocretify。用于下载后续恶意组件。


本次请求的数据是由'用户名计算机名称|||oxepde.dll'组成，与之前一样AES加密再进 行base64编码。拼接前缀data=。


样本把接受的恶意组件，保存在C:\ProgramData\POCM\oxepde.dll路径下。拼 接命令

wmic process where "name='rundll32.exe'" delete"C:\ProgramData\POCM\oxepde.dll",TaskpOp用于结束之前的oxepde.dll进 程。


随后样本对oxepde.dll设置计划任务。schtasks /create /tn "Microsoft run Scheduled" /tr C:\Windows\System32\rundll32.exe "C:\ProgramData\POCM\oxepde.dll",TaskpOp" /sc minute /mo 7

样本将上述计划任务的命令写入Temp\LogicGate路径的djkggosj.bat。随后执行 此bat文件。用于将oxepde.dll设置为计划任务。

样本在C:\ProgramData\POCM路径下创建umnrol.gb，内会记录加密编码后的 本地机器信息。


4.2.3 后门组件Oxepde.dll


SHA256

491daedd7443e4fe93d8e4f065afd768676a30708317f4d152a47e4a c0253695

文件类型

Win32 DLL

文件名

C:\ProgramData\POCM\   oxepde.dll

该样本为上一阶段后门组件从远端下载并加载执行，只有一个导出函数，TaskpOp

样本内部分使用的字符串由AES加密再经过bae64编码进行保存。

样本解密字符串函数第三个参数取值为1和0，1表示解密样本自身携带的字符串。0 表示解密其他字符串。

当解密自身的字符串时，使用的key: 58 DE 47 EC 84 E3 C1 49 35 A3 F4 6A E2 46 63 8A， IV：5A EA 3E 37 C6 94 BC 29 77 60 6F 8D 45 EA CE 5A。

key: 32 A3 D5 97 6E 5A BC F5 C4 68 A8 24 69 E5 C7 91，IV: 29 A9 B9 E9 E7 E5 E1 A3 A8 67 54 28 BC B7 A2 BE。（与之前使用的一致）使用CBC模式。


与之前umnrol.gb文件内数据加密方式相同。经过base64和aes解密后，得到 hcm/spnov。将每个字节减一，得到倒叙的字符串gbl.romnu。随后以两个字节一组， 进行反转。

部分加密字符串用途说明


样本访问umnrol.gb，读取其中内容。

样本使用key: FC FA BC 69 6E AF 9E 83 38 A2 A3 F3 FB 9B B1 B3。IV: 5E 54 4A 3D E9 E2 2C 29 CE BA C7 AC D9 62 77 32。CBC模式，加密读取的umnrol.gb 内的数据。拼接前缀data=。解密url等。

## 样本C2通信，C2: tiffyservics.info

样本通过ObtainUserAgentString检测代理相关信息

随后样本进行网络通信

如果接受C2数据含有'?'，表明为数据下载。同oxepde.dll下载时的通信流程。

否则C2返回的是插件指令。数据示例如下：

如果此时C2失效。读取备用谷歌网盘。从网盘内下载一段字符串，该字符串会解密 出新的C2。分析时，此网盘的url下载字符串无法解密出正常C2地址。

样本对接收的数据进行分割。

以Ky1990point.dll&gt;230410&gt;0&gt;Bringpont&gt;0为例，样本随后基于'&gt;'字符进行 分割。

其中Ky1990point.dll为之后要访问插件名称。

230410之后并未被使用。

0表示执行功能号

Bringpont对应的dll的导出函数

0未被使用

样本基于功能号执行不同功能。


样本把下载的文件保存到本地

执行下载的插件

case -5主要功能是删除插件。样本首先停止插件执行；


下载和执行新插件。

结语

从俄乌冲突到巴以冲突，再到印巴冲突，网络空间攻防对抗已深度融入地 缘政治博弈和对抗。其战略价值不亚于传统军事力量，成为确保国家安全、增 强国防实力的重要领域之一。

地缘政治势力背景APT组织展开的网络攻击，破坏性和影响力愈来愈难以 估量：从攻击渗透政府、军事等重点目标，窃取情报数据；到伪造和传播虚假 消息或视频，影响国际舆论；甚至通过网络攻击，瘫痪军事以及民生关键基础 设施和服务造成广泛影响。网络空间已成为继陆、海、空、天之后的"第五作战 域"，既是和平时代政治势力间角力的暗箭，也是冲突对抗中先发制人的明枪。

如何应对和防御APT威胁成为全球各国网络空间的重要挑战。360安全大 脑实践表明基于特征检测的传统防御手段对APT攻击威胁的识别存在不足和滞 后，难以应对新形势下网络空间的高级威胁，需构建融合大数据、AI技术和威 胁情报共享的国家级监测和防御体系框架，来有效防御和对抗APT攻击威胁。

团队介绍

TEAM INTRODUCTION

## 360高级威胁研究院

360高级威胁研究院是360数字安全集团的核心能力支持部门，由360资深安全专家组成，专注于高级威胁 的发现、防御、处置和研究，曾在全球范围内率先捕获双杀、双星、噩梦公式等多起业界知名的0day在野 攻击，独家披露多个国家级APT组织的高级行动，赢得业内外的广泛认可，为360保障国家网络安全提供 有力支撑。

APT · 目录

上一篇· APT-C-51（APT35）组织最新攻击活动分析